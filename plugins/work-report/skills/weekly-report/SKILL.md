---
name: weekly-report
description: 生成工作周报，汇总本周工作。当用户需要创建周报、汇总日报、生成本周/上周工作总结时触发。支持从日报汇总、交互式填写、数据导入三种模式。
allowed-tools: Read, Write, Edit, Bash(date:*), Glob, AskUserQuestion, TodoWrite
---

# 工作周报生成

## 快速开始

从日报汇总（最常用）:

```bash
# 1. 获取今天星期几和本周日期范围
weekday=$(date +%u)
monday=$(date -v-$((weekday-1))d +%Y-%m-%d)
sunday=$(date -v+$((7-weekday))d +%Y-%m-%d)

# 2. 查找本周日报文件
ls 日报_${monday}*.md 日报_*.md 2>/dev/null | grep -E "日报_[0-9]{4}-[0-9]{2}-[0-9]{2}"
```

## 参考文档

| 文档 | 用途 |
|------|------|
| `references/detailed-workflow.md` | 各模式详细工作流程 |
| `../shared/task-type-rules.md` | 任务类型推断规则 |
| `../shared/table-fields.md` | 9字段表格规范 |
| `../shared/date-calculation.md` | 日期计算逻辑 |

## 关键约束

| 约束 | 规则 |
|------|------|
| 日期确认 | **必须**先明确"本周"还是"上周" |
| 日期计算 | 使用 `date +%u` 获取星期几，参阅 date-calculation.md |
| 任务去重 | 跨天任务只统计一次 |

## 周报结构

| 部分 | 内容 |
|------|------|
| 本周工作总结 | 概述 + 3个9字段表格 |
| 关键进展 | 2-3个要点 |
| 问题反馈 | 困难、需协调资源 |
| 下周计划 | 下周任务 |
| 统计信息 | 总工时、AI辅助率、完成数 |

## 工作流程

1. **初始化**: 确认本周/上周、计算日期范围、确认给用户
2. **选择模式**: 从日报汇总 / 交互式 / 数据导入 / 空白模板
3. **执行**: 按 `references/detailed-workflow.md` 执行对应模式
4. **生成**: 4部分 + 3表格 + 统计 → `周报_YYYY年MM月DD日-MM月DD日.md`

## 错误处理

| 场景 | 处理 |
|------|------|
| 无日报文件 | 建议其他模式 |
| 周报已存在 | 询问覆盖 |
| 日期范围无效 | 要求重新确认 |

## 成功标准

生成的周报必须包含:
- 4个主要部分（总结、进展、问题、计划）
- 3个完整的9字段表格
- 准确的统计信息
